# =============================================================================
# Savvy Funnel Analytics Dashboard - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your actual values
# Never commit .env to git (it's in .gitignore)

# =============================================================================
# NextAuth Configuration
# =============================================================================
# Required for authentication
NEXTAUTH_SECRET=your-nextauth-secret-here-generate-with-openssl-rand-base64-32
# For LOCAL dev use http://localhost:3000 (and add that callback in Google Console).
# For Vercel, set NEXTAUTH_URL in project env vars (e.g. https://your-app.vercel.app).
NEXTAUTH_URL=http://localhost:3000

# Google OAuth (optional - for Sign in with Google)
# Create OAuth 2.0 credentials at https://console.cloud.google.com/apis/credentials
# Use @savvywealth.com accounts; users must be pre-created by an admin
# Authorized redirect URIs in Google Console must include BOTH:
#   - http://localhost:3000/api/auth/callback/google  (local dev)
#   - https://your-production-domain/api/auth/callback/google  (production)
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# =============================================================================
# Database Connection (PostgreSQL/Neon)
# =============================================================================
# Primary database connection string (required)
# For Neon: Use the pooled connection URL (with -pooler in hostname)
# Example: postgresql://user:password@ep-name-pooler.region.aws.neon.tech:5432/dbname?sslmode=require
DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require

# For Neon Local Development (Optional):
# Use direct connection URL (without pooler) for local dev to avoid connection issues
# Get this from Neon dashboard: Connection String > Direct connection
# DIRECT_URL=postgresql://user:password@ep-name.region.aws.neon.tech:5432/dbname?sslmode=require

# Alternative: Use individual connection parameters
# PGHOST=your-postgres-host-pooler
# PGHOST_UNPOOLED=your-postgres-host
# PGUSER=your-postgres-user
# PGDATABASE=your-postgres-database
# PGPASSWORD=your-postgres-password

# Vercel Postgres Template Variables (alternative format)
# POSTGRES_URL=postgresql://user:password@host:port/database?sslmode=require
# POSTGRES_URL_NON_POOLING=postgresql://user:password@host:port/database?sslmode=require
# POSTGRES_USER=your-postgres-user
# POSTGRES_HOST=your-postgres-host-pooler
# POSTGRES_PASSWORD=your-postgres-password
# POSTGRES_DATABASE=your-postgres-database
# POSTGRES_PRISMA_URL=postgresql://user:password@host:port/database?connect_timeout=15&sslmode=require

# =============================================================================
# BigQuery Connection Settings
# =============================================================================
# Your GCP Project ID (optional, defaults to 'savvy-gtm-analytics')
GCP_PROJECT_ID=savvy-gtm-analytics

# Option 1: For LOCAL DEVELOPMENT - Path to service account JSON key file
GOOGLE_APPLICATION_CREDENTIALS=./service-account-key.json

# Option 2: For VERCEL DEPLOYMENT - JSON credentials as environment variable
# IMPORTANT: This should be a single-line JSON string (no newlines)
# GOOGLE_APPLICATION_CREDENTIALS_JSON={"type":"service_account","project_id":"savvy-gtm-analytics","private_key_id":"...","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n","client_email":"...","client_id":"...","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"..."}

# =============================================================================
# Google Sheets Export (Optional)
# =============================================================================
# Google Apps Script Web App URL for creating sheets
GOOGLE_SHEETS_WEBAPP_URL=https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec

# Option 1: For VERCEL DEPLOYMENT - JSON credentials as environment variable
# GOOGLE_SHEETS_CREDENTIALS_JSON={"type":"service_account","project_id":"...","private_key":"...","client_email":"..."}

# Option 2: For LOCAL DEVELOPMENT - Path to service account JSON key file
# GOOGLE_SHEETS_SERVICE_ACCOUNT_PATH=./google-sheets-service-account.json

# =============================================================================
# Anthropic AI (Claude) API - For Explore Feature
# =============================================================================
# Required for the self-service analytics explore feature
# Get your API key from https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-...

# =============================================================================
# Optional: Neon Auth (if using Neon database)
# =============================================================================
# NEXT_PUBLIC_STACK_PROJECT_ID=your-stack-project-id
# NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=your-stack-publishable-client-key
# STACK_SECRET_SERVER_KEY=your-stack-secret-server-key

# =============================================================================

# =============================================================================
# Vercel Cron Jobs - Cache Invalidation
# =============================================================================
# Secret for authenticating cron job requests from Vercel
# Required for /api/cron/refresh-cache endpoint
# Generate a random secret (32+ characters recommended)
# For production: Set this in Vercel dashboard under Settings > Environment Variables
# For local testing: Add to your .env file with a test value
CRON_SECRET=your-cron-secret-here-generate-random-32-char-string

# =============================================================================
# Notes
# =============================================================================
# - VERCEL_URL and VERCEL_BRANCH_URL are automatically set by Vercel (don't set manually)
# - NODE_ENV is automatically set by Next.js (don't set manually)
# - For production deployments on Vercel, set all values in Vercel dashboard under Settings > Environment Variables
# - For local development, copy this file to .env and fill in your values

# =============================================================================
# Password Features (forgot-password, reset link base URL)
# =============================================================================
SENDGRID_API_KEY=SG.xxxx
EMAIL_FROM=your-personal-gmail@gmail.com
# ^ Use personal Gmail; @savvywealth.com DMARC blocks unauthenticated SendGrid
NEXT_PUBLIC_APP_URL=http://localhost:3000

# =============================================================================
# Rate Limiting (Upstash Redis)
# =============================================================================
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-token

# =============================================================================
# Sentry Error Monitoring
# =============================================================================
# Sentry DSN for error tracking (configured in Vercel environment variables)
SENTRY_DSN=your-sentry-dsn-here
NEXT_PUBLIC_SENTRY_DSN=your-sentry-dsn-here

# =============================================================================
# Wrike Integration (Dashboard Requests)
# =============================================================================
# Wrike API access token - get from Wrike App settings or OAuth
# Required for syncing dashboard requests to Wrike tasks
WRIKE_ACCESS_TOKEN=your-wrike-access-token

# Wrike folder ID where tasks will be created
# Discovered folders: "Rev Ops" (MQAAAAECwHhs), "Dashboards" (MQAAAAEEBpOb)
# Run `npx ts-node scripts/discover-wrike.ts` to discover folder IDs
WRIKE_FOLDER_ID=MQAAAAECwHhs

# Webhook secret for verifying incoming Wrike webhook requests
# Generate a random string (32+ characters recommended)
WRIKE_WEBHOOK_SECRET=your-random-webhook-secret-here

# =============================================================================
# Metabase Integration (Chart Builder)
# =============================================================================
# Metabase instance URL - get from your Metabase deployment (Railway, Render, etc.)
METABASE_SITE_URL=https://your-metabase-instance.up.railway.app

# Metabase embedding secret key - get from Metabase Admin > Settings > Embedding
# Required for signed JWT embedding (secure iframe embeds)
METABASE_SECRET_KEY=your-metabase-embedding-secret-key

# Public Metabase URL (same as METABASE_SITE_URL, but accessible client-side)
# Used for the Chart Builder iframe URL
NEXT_PUBLIC_METABASE_SITE_URL=https://your-metabase-instance.up.railway.app

# Metabase API credentials (for fetching saved questions/dashboards)
# Use your Metabase admin email and password
METABASE_API_EMAIL=admin@yourcompany.com
METABASE_API_PASSWORD=your-metabase-admin-password
